{
  "modules": [
    {
      "name": "network_scanner",
      "enabled": true,
      "config": {
        "targets": [
          {
            "host": "127.0.0.1",
            "ports": [22, 80, 443]
          }
        ],
        "timeout_seconds": 1.0
      }
    },
    {
      "name": "local_security_scanner",
      "enabled": true,
      "config": {}
    }
  ],
  "reporting": {
    "format": "text"
  },
  "risk": {
    "severity_thresholds": {
      "info": 10,
      "low": 25,
      "medium": 50,
      "high": 75,
      "critical": 95
    },
    "port_risk_mappings": {
      "high_risk_ports": [21, 23, 135, 139, 445, 1433, 3306, 5432, 3389, 5900, 5985, 5986],
      "medium_risk_ports": [22, 80, 161, 443, 2049, 6379, 27017, 8080, 8443]
    },
    "protocol_checks": {
      "check_ftp_anonymous": true,
      "check_telnet": true
    }
  },
  "collectors": {
    "enabled": true,
    "metrics_interval_ms": 1000,
    "log_interval_ms": 500,
    "auth_log_file": "",
    "log_failure_threshold": 5
  },
  "mitre": {
    "mapping_file": "rules/mitre-mapping.yaml"
  },
  "rba": {
    "severity_weights": {
      "critical": 100,
      "high": 70,
      "medium": 40,
      "low": 15,
      "info": 5
    }
  },
  "persistence": {
    "enabled": true,
    "backend": "sqlite",
    "sqlite_path": "data/soc_audit.db",
    "json_path": "data/soc_audit_store.json",
    "suppressions_path": "config/suppressions.json"
  },
  "incidents": {
    "group_window_seconds": 300
  },
  "backend": {
    "enabled": false,
    "host": "127.0.0.1",
    "port": 8001,
    "api_url": "http://127.0.0.1:8001",
    "ws_url": "ws://127.0.0.1:8001/ws/stream",
    "poll_interval_seconds": 25,
    "use_websocket": true,
    "api_key": "ADMIN_KEY",
    "role": "analyst",
    "auth": {
      "enabled": true,
      "keys": [
        {"key": "ADMIN_KEY", "role": "admin"},
        {"key": "ANALYST_KEY", "role": "analyst"},
        {"key": "AGENT_KEY", "role": "agent"}
      ]
    },
    "storage": {
      "sqlite_path": "data/soc_audit_server.db",
      "json_path": "data/soc_audit_server_store.json"
    },
    "incidents": {
      "group_window_seconds": 300
    }
  },
  "agent": {
    "enabled": false,
    "host_id": "agent-1",
    "host_name": "Example Host",
    "server_url": "http://127.0.0.1:8001",
    "api_key": "AGENT_KEY",
    "heartbeat_interval": 10,
    "batch_interval": 5,
    "retry_initial_seconds": 1,
    "retry_max_seconds": 30
  },
  "local_security_scans": {
    "enabled": true,
    "firewall": {
      "enabled": true,
      "check_firewall_enabled": true,
      "check_default_inbound_policy": true,
      "check_allow_all_rules": true,
      "check_open_inbound_rules": true,
      "check_logging_enabled": true,
      "platforms": {
        "windows_defender_firewall": true,
        "iptables": true,
        "nftables": true
      }
    },
    "authentication": {
      "enabled": true,
      "check_local_admin_accounts": true,
      "check_guest_account_status": true,
      "check_password_policy": {
        "min_length": 12,
        "require_complexity": true
      },
      "check_account_lockout_policy": true
    },
    "logging": {
      "enabled": true,
      "check_audit_logging_enabled": true,
      "check_auth_log_sources": true,
      "check_log_retention_days": {
        "minimum": 30
      },
      "check_log_file_permissions": true
    },
    "system_hardening": {
      "enabled": true,
      "check_secure_boot": true,
      "check_disk_encryption": true,
      "check_automatic_updates_enabled": true,
      "check_time_sync_enabled": true
    },
    "endpoint_protection": {
      "enabled": true,
      "check_antivirus_present": true,
      "check_real_time_protection": true,
      "check_tamper_protection": true
    }
  }
}
